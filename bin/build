#!/usr/bin/env ruby

require 'fileutils'
require 'zlib'

SPLITTER = /\s*,\s*/

raise 'lang and platform not provided' unless ARGV[0] && ARGV[1] && ARGV[2]

name = ARGV[0]
@langs = [''] + ARGV[1].split(SPLITTER)
@platforms = ['common'] + ARGV[2].split(SPLITTER)
@build_path = "tmp.build/#{name}/man1/"


def cp_tmp_man path
  if File.exist?(path)
    FileUtils.cp(Dir[File.join(path,'*.gz')], @build_path) 
  end
end


@langs.each do |lang|
  lang = '.'+lang if lang!=''

  @platforms.each do |plf|
    cp_tmp_man "tmp.man/pages#{lang}/#{plf}/" 
  end
end

FileUtils.mkdir_p(@build_path)

%x|zip -r #{name}.zip #{@build_path}|







